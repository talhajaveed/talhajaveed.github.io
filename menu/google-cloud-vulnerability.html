<!DOCTYPE html>
<html lang="en-US">

<!-- Mirrored from www.loosebyte.com/google-cloud-vulnerability/ by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 25 Feb 2020 07:23:18 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
	<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
	

	<script type="text/javascript">
		document.documentElement.className = 'js';
	</script>

	<script id="Cookiebot" src="../../consent.cookiebot.com/uc.js"  data-cbid="528a2d5c-7fd1-464a-bd9d-46c19a4f67c3" type="text/javascript" ></script><script>var et_site_url='../index.html';var et_post_id='394';function et_core_page_resource_fallback(a,b){"undefined"===typeof b&&(b=a.sheet.cssRules&&0===a.sheet.cssRules.length);b&&(a.onerror=null,a.onload=null,a.href?a.href=et_site_url+"/?et_core_page_resource="+a.id+et_post_id:a.src&&(a.src=et_site_url+"/?et_core_page_resource="+a.id+et_post_id))}
</script><title>LooseByte | Google Cloud Blog platform vulnerability</title>

<!-- This site is optimized with the Yoast SEO plugin v13.1 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="A write-up about one vulnerability found by our team in the Google Cloud Blog platform."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="index.html" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="LooseByte | Google Cloud Blog platform vulnerability" />
<meta property="og:description" content="A write-up about one vulnerability found by our team in the Google Cloud Blog platform." />
<meta property="og:url" content="https://www.loosebyte.com/google-cloud-vulnerability/" />
<meta property="og:site_name" content="LooseByte" />
<meta property="article:publisher" content="https://www.facebook.com/loosebyte" />
<meta property="article:section" content="BugBounty" />
<meta property="article:published_time" content="2019-09-01T23:13:46+00:00" />
<meta property="article:modified_time" content="2019-10-08T12:29:00+00:00" />
<meta property="og:updated_time" content="2019-10-08T12:29:00+00:00" />
<meta property="og:image" content="https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-logo2.jpg" />
<meta property="og:image:secure_url" content="https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-logo2.jpg" />
<meta property="og:image:width" content="1384" />
<meta property="og:image:height" content="831" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="A write-up about one vulnerability found by our team in the Google Cloud Blog platform." />
<meta name="twitter:title" content="LooseByte | Google Cloud Blog platform vulnerability" />
<meta name="twitter:site" content="@loose_byte" />
<meta name="twitter:image" content="https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-logo2.jpg" />
<meta name="twitter:creator" content="@loose_byte" />
<script type='application/ld+json' class='yoast-schema-graph yoast-schema-graph--main'>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://www.loosebyte.com/#organization","name":"Loose Byte S.R.L.","url":"https://www.loosebyte.com/","sameAs":["https://www.facebook.com/loosebyte","https://www.linkedin.com/company/loosebyte/","https://twitter.com/loose_byte"],"logo":{"@type":"ImageObject","@id":"https://www.loosebyte.com/#logo","inLanguage":"en-US","url":"https://www.loosebyte.com/wp-content/uploads/2019/09/loosebyte-logo-v2.png","width":1024,"height":224,"caption":"Loose Byte S.R.L."},"image":{"@id":"https://www.loosebyte.com/#logo"}},{"@type":"WebSite","@id":"https://www.loosebyte.com/#website","url":"https://www.loosebyte.com/","name":"LooseByte","inLanguage":"en-US","description":"Grow Your Business Safely With High-Quality Security Solutions","publisher":{"@id":"https://www.loosebyte.com/#organization"},"potentialAction":{"@type":"SearchAction","target":"https://www.loosebyte.com/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://www.loosebyte.com/google-cloud-vulnerability/#primaryimage","inLanguage":"en-US","url":"https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-logo2.jpg","width":1384,"height":831,"caption":"google cloud logo"},{"@type":"WebPage","@id":"https://www.loosebyte.com/google-cloud-vulnerability/#webpage","url":"https://www.loosebyte.com/google-cloud-vulnerability/","name":"LooseByte | Google Cloud Blog platform vulnerability","isPartOf":{"@id":"https://www.loosebyte.com/#website"},"inLanguage":"en-US","primaryImageOfPage":{"@id":"https://www.loosebyte.com/google-cloud-vulnerability/#primaryimage"},"datePublished":"2019-09-01T23:13:46+00:00","dateModified":"2019-10-08T12:29:00+00:00","description":"A write-up about one vulnerability found by our team in the Google Cloud Blog platform."},{"@type":"Article","@id":"https://www.loosebyte.com/google-cloud-vulnerability/#article","isPartOf":{"@id":"https://www.loosebyte.com/google-cloud-vulnerability/#webpage"},"author":{"@id":"https://www.loosebyte.com/#/schema/person/879c3fd3204eb8918db644accf3df49a"},"headline":"Google Cloud Blog platform vulnerability","datePublished":"2019-09-01T23:13:46+00:00","dateModified":"2019-10-08T12:29:00+00:00","commentCount":0,"mainEntityOfPage":{"@id":"https://www.loosebyte.com/google-cloud-vulnerability/#webpage"},"publisher":{"@id":"https://www.loosebyte.com/#organization"},"image":{"@id":"https://www.loosebyte.com/google-cloud-vulnerability/#primaryimage"},"articleSection":"BugBounty","inLanguage":"en-US"},{"@type":["Person"],"@id":"https://www.loosebyte.com/#/schema/person/879c3fd3204eb8918db644accf3df49a","name":"admin","image":{"@type":"ImageObject","@id":"https://www.loosebyte.com/#authorlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/0900dd7f16549971fe2a4396815fdb2f?s=96&d=mm&r=g","caption":"admin"},"sameAs":[]}]}</script>
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='http://fonts.googleapis.com/' />
<link href='https://fonts.gstatic.com/' crossorigin rel='preconnect' />
<link rel="alternate" type="application/rss+xml" title="LooseByte &raquo; Feed" href="../feed/index.html" />
<link  rel='stylesheet' id='wpacu-combined-css-head-1' href='../wp-content/cache/asset-cleanup/css/head-6f50ddb39758d8db5fd50954554ad712c6d7ed9a.css' type='text/css' media='all' /><link rel='preload' as="style" onload="this.rel='stylesheet'" data-wpacu-preload-it-async='1' id='wpacu-combined-google-fonts-css-async-preload' href='https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic|Raleway:100,100italic,200,200italic,300,300italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic,italic,regular|Titillium+Web:200,200italic,300,300italic,600,600italic,700,700italic,900,italic,regular&amp;subset=latin,latin-ext&amp;display=swap' type='text/css' media='all' />
<script id="wpacu-preload-async-css-fallback">
    /*! LoadCSS. [c]2017 Filament Group, Inc. MIT License */
    /* This file is meant as a standalone workflow for
	- testing support for link[rel=preload]
	- enabling async CSS loading in browsers that do not support rel=preload
	- applying rel preload css once loaded, whether supported or not.
	*/
    !function(n){"use strict";n.wpacuLoadCSS||(n.wpacuLoadCSS=function(){});var o=wpacuLoadCSS.relpreload={};if(o.support=function(){var e;try{e=n.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),o.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},o.poly=function(){if(!o.support())for(var t=n.document.getElementsByTagName("link"),e=0;e<t.length;e++){var a=t[e];"preload"!==a.rel||"style"!==a.getAttribute("as")||a.getAttribute("data-wpacuLoadCSS")||(a.setAttribute("data-wpacuLoadCSS",!0),o.bindMediaToggle(a))}},!o.support()){o.poly();var t=n.setInterval(o.poly,500);n.addEventListener?n.addEventListener("load",function(){o.poly(),n.clearInterval(t)}):n.attachEvent&&n.attachEvent("onload",function(){o.poly(),n.clearInterval(t)})}"undefined"!=typeof exports?exports.wpacuLoadCSS=wpacuLoadCSS:n.wpacuLoadCSS=wpacuLoadCSS}("undefined"!=typeof global?global:this);
</script>
<script  id='wpacu-combined-js-head-group-1' type='text/javascript' src='../wp-content/cache/asset-cleanup/js/head-f8ab0aa726219caddc4cdeb345bc8711bb5275af-1.js'></script>

<script  id='wpacu-combined-js-head-group-2' type='text/javascript' src='../wp-content/cache/asset-cleanup/js/head-11603a59ad1515e104f49059fc636a856fddcc1a-2.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var et_core_api_spam_recaptcha = {"site_key":"","page_action":{"action":"googlecloudvulnerability"}};
/* ]]> */
</script>
<script   type='text/javascript' src='../wp-content/cache/asset-cleanup/js/item/et-core-api-spam-recaptcha-v5.3.2-5bbb2d7251e4092bddc4c6597df1d326e9d2d600.js'></script>
<link rel='shortlink' href='../index51fe.html?p=394' />
<link rel="alternate" hreflang="en-US" href="index.html"/>
<link rel="alternate" hreflang="ro-RO" href="../ro/google-cloud-vulnerability/index.html"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
<!-- Facebook Pixel Code -->
<script type='text/javascript'>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','../../connect.facebook.net/en_US/fbevents.js');
</script>
<!-- End Facebook Pixel Code -->
<script type='text/javascript'>
  fbq('init', '980952672034935', [], {
    "agent": "wordpress-5.3.2-1.8.0"
});
</script><script type='text/javascript'>
  fbq('track', 'PageView', []);
</script>
<!-- Facebook Pixel Code -->
<noscript>
<img height="1" width="1" style="display:none" alt="fbpx"
src="https://www.facebook.com/tr?id=980952672034935&amp;ev=PageView&amp;noscript=1" />
</noscript>
<!-- End Facebook Pixel Code -->
<style type="text/css">.rv_button.closed:after{content:"\33"}.rv_button.opened:after{content:"\32"}</style><!--
<script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="528a2d5c-7fd1-464a-bd9d-46c19a4f67c3" data-blockingmode="auto" type="text/javascript"></script>

--><link rel="icon" href="../wp-content/uploads/2019/09/cropped-Logo-LooseByte-1-32x32.png" sizes="32x32" />
<link rel="icon" href="../wp-content/uploads/2019/09/cropped-Logo-LooseByte-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="../wp-content/uploads/2019/09/cropped-Logo-LooseByte-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.loosebyte.com/wp-content/uploads/2019/09/cropped-Logo-LooseByte-1-270x270.png" />
</head>
<body class="post-template-default single single-post postid-394 single-format-standard translatepress-en_US et_pb_button_helper_class et_fullwidth_nav et_fixed_nav et_show_nav et_primary_nav_dropdown_animation_fade et_secondary_nav_dropdown_animation_fade et_header_style_left et_pb_footer_columns4 et_cover_background et_pb_gutter windows et_pb_gutters3 et_pb_pagebuilder_layout et_right_sidebar et_divi_theme et-db et_minified_js et_minified_css">
	<div id="page-container">

	
	
			<header id="main-header" data-height-onload="66">
			<div class="container clearfix et_menu_container">
							<div class="logo_container">
					<span class="logo_helper"></span>
					<a href="../index.html">
						<img src="../wp-content/uploads/2019/09/loosebyte-logo-v2.png" alt="LooseByte" id="logo" data-height-percentage="80" />
					</a>
				</div>
							<div id="et-top-navigation" data-height="66" data-fixed-height="40">
											<nav id="top-menu-nav">
						<ul id="top-menu" class="nav"><li id="menu-item-398" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-398"><a href="../index.html">Home</a></li>
<li id="menu-item-399" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-399"><a href="../about-us/index.html">About Us</a></li>
<li id="menu-item-526" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-526"><a href="#">Services</a>
<ul class="sub-menu">
	<li id="menu-item-529" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-529"><a href="../pentesting/index.html">Penetration Testing</a></li>
	<li id="menu-item-527" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-527"><a href="../vulnerability-assesment/index.html">Vulnerability Assesment</a></li>
	<li id="menu-item-528" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-528"><a href="../secure-code-review/index.html">Secure Code Review</a></li>
	<li id="menu-item-736" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-736"><a href="../phishing-exercise/index.html">Phishing Exercise</a></li>
</ul>
</li>
<li id="menu-item-403" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-403"><a href="../blog/index.html">Blog</a></li>
<li id="menu-item-400" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-400"><a href="../contact/index.html">Contact</a></li>
</ul>						</nav>
					
					
					
										<div id="et_top_search">
						<span id="et_search_icon"></span>
					</div>
					
					<div id="et_mobile_nav_menu">
				<div class="mobile_nav closed">
					<span class="select_page">Select Page</span>
					<span class="mobile_menu_bar mobile_menu_bar_toggle"></span>
				</div>
			</div>				</div> <!-- #et-top-navigation -->
			</div> <!-- .container -->
			<div class="et_search_outer">
				<div class="container et_search_form_container">
					<form role="search" method="get" class="et-search-form" action="https://www.loosebyte.com/">
					<input type="search" class="et-search-field" placeholder="Search &hellip;" value="" name="s" title="Search for:" />					</form>
					<span class="et_close_search_field"></span>
				</div>
			</div>
		</header> <!-- #main-header -->
			<div id="et-main-area">
	
<div id="main-content">
		<div class="container">
		<div id="content-area" class="clearfix">
			<div id="left-area">
											<article id="post-394" class="et_pb_post post-394 post type-post status-publish format-standard has-post-thumbnail hentry category-bugbounty">
											<div class="et_post_meta_wrapper">
							<h1 class="entry-title">Google Cloud Blog platform vulnerability</h1>

						<p class="post-meta"> by <span class="author vcard"><a href="../author/admin/index.html" title="Posts by admin" rel="author">admin</a></span> | <span class="published">Sep 1, 2019</span> | <a href="../category/bugbounty/index.html" rel="category tag">BugBounty</a></p><img src="../wp-content/uploads/2019/09/google-cloud-logo2-1080x675.jpg" alt="google cloud logo" class="" width='1080' height='675' srcset="https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-logo2-980x588.jpg 980w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-logo2-480x288.jpg 480w" sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) 1080px, 100vw" />
												</div> <!-- .et_post_meta_wrapper -->
				
					<div class="entry-content">
					<div id="et-boc" class="et-boc">
			
		<div class="et-l et-l--post">
			<div class="et_builder_inner_content et_pb_gutters3"><div class="et_pb_section et_pb_section_0 et_section_regular" >
				
				
				
				
					<div class="et_pb_row et_pb_row_0">
				<div class="et_pb_column et_pb_column_4_4 et_pb_column_0  et_pb_css_mix_blend_mode_passthrough et-last-child">
				
				
				<div class="et_pb_module et_pb_text et_pb_text_0  et_pb_text_align_left et_pb_bg_layout_light">
				
				
				<div class="et_pb_text_inner"><span>Hi there,</span></p>
<p><span>In today&#8217;s post, I will talk with you about an interesting security vulnerability that I&#8217;ve found while I was working for one of my <a href="https://www.google.com/about/appsecurity/research-grants/">Google Grants</a>. In case you don&#8217;t know, Google Grants is a program that complements the Google Vulnerability Reward Program (VRP) where bug-hunters receive different grants(rewards) for researching(testing) Google products.</span></p>
<p>&nbsp;</p>
<blockquote>
<h2>About Google Cloud Blog</h2>
</blockquote>
<p>As the name suggests, <a href="https://cloud.google.com/blog/">Google Cloud Blog</a> is the platform used by Google for presenting newly launched features and announcements for the Google Cloud Platform (GCP), a very cool suite of cloud computing services. One day I was announced that I&#8217;ve got a grant for this blog platform and I thought it was a good opportunity for me to improve my skills while having a little bit of fun.</p>
<p>&nbsp;</p>
<blockquote>
<h2>First impression</h2>
</blockquote>
<p>I started to interact with the web application and follow my usual reconnaissance steps while also trying to understand which are the main features of the web application and how does it process the data which comes from the end-user. After crawling and inspecting the existent web pages I realized that the application was designed more like a read-only website, rather than one which process input-data coming from the user. I started to look for implemented functionalities, but I couldn&#8217;t find anything else accessible except the Search feature. Bruteforcing existent files and folders didn&#8217;t give any useful result and for that moment I felt like I was stuck and as I didn&#8217;t have many ideas.</p>
<p>I decided then to take a different testing approach and start analyzing the frontend JavaScript code modules. Using the Google Chrome Developer Console, I saw which were the JS source code files loaded into the application, and one of them got my attention: <em>https://cloud.google.com/blog/static/<strong>main</strong>.163de04176b97472487f.bundle.js</em>. This JavaScript file represented the main module of the application and contained the code for various functionalities.</p>
<p>&nbsp;</p>
<blockquote>
<h2>Breaking the ice</h2>
</blockquote>
<p>As the number of lines of code was about ~29k, it wasn&#8217;t very efficient to take every line one by one, so I started to look for variables and functions which may be responsible for handling user-input data like &#8220;query&#8221;, &#8220;queryParams&#8221;, &#8220;URL&#8221; etc. This was the way I found the following line:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e54cb3be2f35190278766" class="crayon-syntax crayon-theme-cg-cookie crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
e.prototype.resolve = function(e) {
    return e.queryParams.previewUrl ? this.wagtailApiService.getPreviewPageData(e.queryParams.previewUrl) :
        this.getPageDataObservable(this.getUrlString(e))
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e54cb3be2f35190278766-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e54cb3be2f35190278766-2">2</div><div class="crayon-num" data-line="crayon-5e54cb3be2f35190278766-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e54cb3be2f35190278766-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e54cb3be2f35190278766-1"><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-v">prototype</span><span class="crayon-sy">.</span><span class="crayon-v">resolve</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">e</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e54cb3be2f35190278766-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-v">queryParams</span><span class="crayon-sy">.</span><span class="crayon-i">previewUrl</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">wagtailApiService</span><span class="crayon-sy">.</span><span class="crayon-e">getPreviewPageData</span><span class="crayon-sy">(</span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-v">queryParams</span><span class="crayon-sy">.</span><span class="crayon-v">previewUrl</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5e54cb3be2f35190278766-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-e">getPageDataObservable</span><span class="crayon-sy">(</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-e">getUrlString</span><span class="crayon-sy">(</span><span class="crayon-v">e</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e54cb3be2f35190278766-4"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></div>
			</div> <!-- .et_pb_text --><div class="et_pb_module et_pb_image et_pb_image_0">
				
				
				<a href="../wp-content/uploads/2019/09/google-cloud-xss-poc-2.png" class="et_pb_lightbox_image" title=""><span class="et_pb_image_wrap "><img src="../wp-content/uploads/2019/09/google-cloud-xss-poc-2.png" alt="" title="" srcset="https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-2-2880x1800.png 2048w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-2-1280x800.png 1280w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-2-980x613.png 980w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-2-480x300.png 480w" sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) and (max-width: 1280px) 1280px, (min-width: 1281px) 2048px, 100vw" /></span></a>
			</div><div class="et_pb_module et_pb_text et_pb_text_1  et_pb_text_align_left et_pb_bg_layout_light">
				
				
				<div class="et_pb_text_inner">which basically checked if there is any &#8220;previewUrl&#8221; parameter in the query string, and if so, it passed it to the <strong>getPreviewPageData </strong>function:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e54cb3be2f3d356442273" class="crayon-syntax crayon-theme-cg-cookie crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
e.prototype.getPreviewPageData = function(e) {
    var t = "" + r.a.AUTHOR_URL + e.replace(/\/?$/, "/") + "?mode=json";
    return this.httpClient.get(t, {
        withCredentials: !0
    })
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e54cb3be2f3d356442273-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e54cb3be2f3d356442273-2">2</div><div class="crayon-num" data-line="crayon-5e54cb3be2f3d356442273-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e54cb3be2f3d356442273-4">4</div><div class="crayon-num" data-line="crayon-5e54cb3be2f3d356442273-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e54cb3be2f3d356442273-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e54cb3be2f3d356442273-1"><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-v">prototype</span><span class="crayon-sy">.</span><span class="crayon-v">getPreviewPageData</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">e</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e54cb3be2f3d356442273-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">a</span><span class="crayon-sy">.</span><span class="crayon-v">AUTHOR_URL</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-o">/</span><span class="crayon-sy">\</span><span class="crayon-o">/</span><span class="crayon-sy">?</span><span class="crayon-sy">$</span><span class="crayon-o">/</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"/"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"?mode=json"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5e54cb3be2f3d356442273-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">httpClient</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e54cb3be2f3d356442273-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">withCredentials</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5e54cb3be2f3d356442273-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e54cb3be2f3d356442273-6"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></div>
			</div> <!-- .et_pb_text --><div class="et_pb_module et_pb_image et_pb_image_1">
				
				
				<a href="../wp-content/uploads/2019/09/google-cloud-xss-poc-3.png" class="et_pb_lightbox_image" title=""><span class="et_pb_image_wrap "><img src="../wp-content/uploads/2019/09/google-cloud-xss-poc-3.png" alt="" title="" srcset="https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-3-2880x1800.png 2048w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-3-1280x800.png 1280w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-3-980x613.png 980w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-3-480x300.png 480w" sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) and (max-width: 1280px) 1280px, (min-width: 1281px) 2048px, 100vw" /></span></a>
			</div><div class="et_pb_module et_pb_text et_pb_text_2  et_pb_text_align_left et_pb_bg_layout_light">
				
				
				<div class="et_pb_text_inner">What this function did was to construct a URL (variable <strong>t</strong>) and load JSON pre-formatted code from that link. That code was then parsed and <strong>the whole page changed, as it was configured in the JSON file</strong> <strong>retrieved.</strong> From what I understood, this functionality was used by the Google engineers to see a live preview on the production GoogleCloud Blog website, of the code changes they made internally. The other possibility was that the functionality was introduced initially when the application was developed and tested internally and then it was forgotten when the web application was pushed to production.</p>
<p>The resource link was constructed from the input data coming from the user and it was formed by 3 parts:</p>
<ul>
<li>The constant value r.a.AUTHOR_URL which was already defined in the code as a link which pointed to one of google internal subdomains (<a href="https://gweb-cloudblog-author.googleplex.com/">https://gweb-cloudblog-author.googleplex.com</a>)</li>
<li>The value passed as parameter <strong>e </strong>(the <strong>previewUrl </strong>parameter passed earlier), which <strong>should</strong> have been in the form of a path (/folder1/folder2/folder3/)</li>
<li>One query parameter called <strong>mode</strong></li>
</ul>
<p>The expected final URL would have been in the following form:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e54cb3be2f3f771814369" class="crayon-syntax crayon-theme-cg-cookie crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
https://gweb-cloudblog-author.googleplex.com + /path/from/user/ + "?mode=json"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e54cb3be2f3f771814369-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e54cb3be2f3f771814369-1"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//gweb-cloudblog-author.googleplex.com + /path/from/user/ + "?mode=json"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<p>As you may have spotted until now, there was no check in the code to verify if the path appended to the googleplex.com subdomain began indeed with a slash (&#8220;/&#8221;). An attacker could have supplied a value like &#8220;.1337hackz.com/&#8221; and in consequence, initiate a GET request to the following URL:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e54cb3be2f41846737200" class="crayon-syntax crayon-theme-cg-cookie crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
https://gweb-cloudblog-author.googleplex.com.1337hackz.com/?mode=json</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e54cb3be2f41846737200-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e54cb3be2f41846737200-1"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//gweb-cloudblog-author.googleplex.com.1337hackz.com/?mode=json</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<p>As a result, the JSON code was loaded from the attacker&#8217;s controlled website, who could then alter the content a legit article in almost any way he wanted (he could, for example, modify titles, images or body content). Injecting user-controlled content was always an open door for XSS vulnerabilities, but this time I had no luck. Every JavaScript module which was responsible for components used within the article page (titles, paragraphs, embedded images &amp; videos) encoded and filtered any way of injecting malicious code. The article&#8217;s body content, composed of text and HTML tags (which was also fully under the attacker&#8217;s control) was stripped-out of dangerous HTML tags and JavaScripts events.</p>
<p>&nbsp;</div>
			</div> <!-- .et_pb_text --><div class="et_pb_module et_pb_image et_pb_image_2">
				
				
				<a href="../wp-content/uploads/2019/09/google-cloud-xss-poc-1.jpg" class="et_pb_lightbox_image" title=""><span class="et_pb_image_wrap "><img src="../wp-content/uploads/2019/09/google-cloud-xss-poc-1.jpg" alt="" title="" /></span></a>
			</div><div class="et_pb_module et_pb_text et_pb_text_3  et_pb_text_align_left et_pb_bg_layout_light">
				
				
				<div class="et_pb_text_inner"><h2><span></span></h2>
<blockquote>
<h2><span>HTML Content Injection to XSS</span></h2>
</blockquote>
<p>I was ready to create a new report and inform Google about this finding when I decided to take one last shot and see if there isn&#8217;t any way to escalate this vulnerability to a reflected XSS. This is how I got to the following lines of code:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e54cb3be2f44205217909" class="crayon-syntax crayon-theme-cg-cookie crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
if (e.seo_tag) 
this.updateSeoLink(e.seo_tag);
e.prototype.updateSeoLink = function(e) {
    for (var t = 0, n = JSON.parse(e); t &amp;lt; n.length; t++) {
        var r = n[t];
        if (r.type &amp;amp;&amp;amp; "link" === r.type) {
            var i = this.document.createElement("link");
            i.id = "seo-tag", i.href = r.attributes.href, i.hreflang = r.attributes.hreflang, i.rel = r.attributes.rel, this.document.head.appendChild(i)
        }
    }
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e54cb3be2f44205217909-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e54cb3be2f44205217909-2">2</div><div class="crayon-num" data-line="crayon-5e54cb3be2f44205217909-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e54cb3be2f44205217909-4">4</div><div class="crayon-num" data-line="crayon-5e54cb3be2f44205217909-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e54cb3be2f44205217909-6">6</div><div class="crayon-num" data-line="crayon-5e54cb3be2f44205217909-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e54cb3be2f44205217909-8">8</div><div class="crayon-num" data-line="crayon-5e54cb3be2f44205217909-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e54cb3be2f44205217909-10">10</div><div class="crayon-num" data-line="crayon-5e54cb3be2f44205217909-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e54cb3be2f44205217909-1"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-v">seo_tag</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5e54cb3be2f44205217909-2"><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-e">updateSeoLink</span><span class="crayon-sy">(</span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-v">seo_tag</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5e54cb3be2f44205217909-3"><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-v">prototype</span><span class="crayon-sy">.</span><span class="crayon-v">updateSeoLink</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">e</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e54cb3be2f44205217909-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">JSON</span><span class="crayon-sy">.</span><span class="crayon-e">parse</span><span class="crayon-sy">(</span><span class="crayon-v">e</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">.</span><span class="crayon-v">length</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-o">++</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5e54cb3be2f44205217909-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">[</span><span class="crayon-v">t</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e54cb3be2f44205217909-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">type</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"link"</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">type</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5e54cb3be2f44205217909-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-e">createElement</span><span class="crayon-sy">(</span><span class="crayon-s">"link"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e54cb3be2f44205217909-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">i</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"seo-tag"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">.</span><span class="crayon-v">href</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">attributes</span><span class="crayon-sy">.</span><span class="crayon-v">href</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">.</span><span class="crayon-v">hreflang</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">attributes</span><span class="crayon-sy">.</span><span class="crayon-v">hreflang</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">.</span><span class="crayon-v">rel</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">attributes</span><span class="crayon-sy">.</span><span class="crayon-v">rel</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-v">head</span><span class="crayon-sy">.</span><span class="crayon-e">appendChild</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e54cb3be2f44205217909-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e54cb3be2f44205217909-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5e54cb3be2f44205217909-11"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></div>
			</div> <!-- .et_pb_text --><div class="et_pb_module et_pb_image et_pb_image_3">
				
				
				<a href="../wp-content/uploads/2019/09/google-cloud-xss-poc-4.png" class="et_pb_lightbox_image" title=""><span class="et_pb_image_wrap "><img src="../wp-content/uploads/2019/09/google-cloud-xss-poc-4.png" alt="" title="" srcset="https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-4-2880x1800.png 2048w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-4-1280x800.png 1280w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-4-980x613.png 980w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-4-480x300.png 480w" sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) and (max-width: 1280px) 1280px, (min-width: 1281px) 2048px, 100vw" /></span></a>
			</div><div class="et_pb_module et_pb_image et_pb_image_4">
				
				
				<a href="../wp-content/uploads/2019/09/google-cloud-xss-poc-5.png" class="et_pb_lightbox_image" title=""><span class="et_pb_image_wrap "><img src="../wp-content/uploads/2019/09/google-cloud-xss-poc-5.png" alt="" title="" srcset="https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-5-2880x1800.png 2048w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-5-1280x800.png 1280w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-5-980x613.png 980w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-5-480x300.png 480w" sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) and (max-width: 1280px) 1280px, (min-width: 1281px) 2048px, 100vw" /></span></a>
			</div><div class="et_pb_module et_pb_text et_pb_text_4  et_pb_text_align_left et_pb_bg_layout_light">
				
				
				<div class="et_pb_text_inner">The first conditional statement, checked if the JSON file hosted and retrieved from the link constructed earlier, has as one of its parameters, one called <strong>seo_tag</strong>. Just to have an idea, this is how the attacker&#8217;s hosted JSON file should have looked:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e54cb3be2f46621543352" class="crayon-syntax crayon-theme-cg-cookie crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{
    "id": 39049,
    (...)
    "seo_tag": "[{ \"type\": \"link\", \"attributes\":{ \"href\":\"https://gweb-cloudblog-author.googleplex.com.poc.dekeeu.online/test.php\", \"rel\": \"import\", \"hreflang\": \"ro\" } }]"
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e54cb3be2f46621543352-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e54cb3be2f46621543352-2">2</div><div class="crayon-num" data-line="crayon-5e54cb3be2f46621543352-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e54cb3be2f46621543352-4">4</div><div class="crayon-num" data-line="crayon-5e54cb3be2f46621543352-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e54cb3be2f46621543352-1"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e54cb3be2f46621543352-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"id"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">39049</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5e54cb3be2f46621543352-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e54cb3be2f46621543352-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"seo_tag"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"[{ \"type\": \"link\", \"attributes\":{ \"href\":\"https://gweb-cloudblog-author.googleplex.com.poc.dekeeu.online/test.php\", \"rel\": \"import\", \"hreflang\": \"ro\" } }]"</span></div><div class="crayon-line" id="crayon-5e54cb3be2f46621543352-5"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>If this parameter was set, a new &lt;link&gt; tag was dynamically created by the <strong>updateSeoLink</strong> function and appended to the webpage HTML content. This new tag would have had all the attributes specified by the attacker, in the <strong>seo_tag</strong> parameter&#8217;s configuration, but the most important ones were the <strong>href </strong>and <strong>rel.</strong></p>
<p>In the case of an HTML &lt;link&gt; tag, if the <strong>rel </strong>attribute is set to <strong>import</strong> then, the resource pointed by the <strong>href</strong> attribute will be included in the current HTML document. Therefore, if the attacker set the <strong>rel</strong> attribute and pointed the <strong>href</strong> one to a maliciously hosted HTML content, then it would have been possible to insert valid HTML content into the webpage.</p>
<p>However, the CSP header blocked any attempt to load this kind of resource. Nevertheless, I decided to pack up all these details and sent them to Google, since from my point of view was a valid finding and also could have been exploited by an attacker.</div>
			</div> <!-- .et_pb_text --><div class="et_pb_module et_pb_image et_pb_image_5">
				
				
				<a href="../wp-content/uploads/2019/09/google-cloud-xss-poc-6.png" class="et_pb_lightbox_image" title=""><span class="et_pb_image_wrap "><img src="../wp-content/uploads/2019/09/google-cloud-xss-poc-6.png" alt="" title="" srcset="https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-6-2880x1800.png 2048w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-6-1280x800.png 1280w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-6-980x613.png 980w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-6-480x300.png 480w" sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) and (max-width: 1280px) 1280px, (min-width: 1281px) 2048px, 100vw" /></span></a>
			</div><div class="et_pb_module et_pb_image et_pb_image_6">
				
				
				<a href="../wp-content/uploads/2019/09/google-cloud-xss-poc-7.png" class="et_pb_lightbox_image" title=""><span class="et_pb_image_wrap "><img src="../wp-content/uploads/2019/09/google-cloud-xss-poc-7.png" alt="" title="" srcset="https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-7-2880x1800.png 2048w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-7-1280x800.png 1280w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-7-980x613.png 980w, https://www.loosebyte.com/wp-content/uploads/2019/09/google-cloud-xss-poc-7-480x300.png 480w" sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) and (max-width: 1280px) 1280px, (min-width: 1281px) 2048px, 100vw" /></span></a>
			</div><div class="et_pb_module et_pb_text et_pb_text_5  et_pb_text_align_left et_pb_bg_layout_light">
				
				
				<div class="et_pb_text_inner"><h2><span></span></h2>
<blockquote>
<h2><span>Risks</span></h2>
</blockquote>
<p>With this vulnerability, an attacker could have tricked victims into doing a set of illegitimate actions, by modifying the content of a webpage belonging to the GoogleCloud Blog. He could create a malicious link and sent it to his victims over the internet, social media platforms, messages, etc. Also, if a CSP bypass could have been achieved, an attacker could have injected maliciously HTML and JavaScript content into the webpage and steal the sensitive information retained by the browser in the context of the blog platform, like Cookies or Session Tokens.</p>
<p>&nbsp;</p>
<blockquote>
<h2><span>Resolution</span></h2>
</blockquote>
<p>Google Security Team accepted this vulnerability and fixed it very fast, as always. Surprisingly, they treated this bug as an XSS and rewarded it accordingly to the VRP rules.</p>
<p>For me, this story demonstrates once again that even if an application might seem secure at first sight, it may have a security bug and the most important thing is to stay creative and never give up your chance and motivation. I hope you enjoyed this post, see you soon!</p>
<p>&nbsp;</p>
<p>Alexandru Coltuneac, LooseByte</p></div>
			</div> <!-- .et_pb_text -->
			</div> <!-- .et_pb_column -->
				
				
			</div> <!-- .et_pb_row -->
				
				
			</div> <!-- .et_pb_section -->		</div><!-- .et_builder_inner_content -->
	</div><!-- .et-l -->
	
			
		</div><!-- #et-boc -->
							</div> <!-- .entry-content -->
					<div class="et_post_meta_wrapper">
										</div> <!-- .et_post_meta_wrapper -->
				</article> <!-- .et_pb_post -->

						</div> <!-- #left-area -->

				<div id="sidebar">
		<div id="search-2" class="et_pb_widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="https://www.loosebyte.com/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form></div> <!-- end .et_pb_widget -->		<div id="recent-posts-2" class="et_pb_widget widget_recent_entries">		<h4 class="widgettitle">Recent Posts</h4>		<ul>
											<li>
					<a href="../sunt-hacker-si-vreau-sa-ajut-companiile-din-romania-sa-fie-mai-sigure/index.html">Sunt Hacker și vreau să ajut companiile din România să fie mai sigure</a>
									</li>
											<li>
					<a href="index.html" aria-current="page">Google Cloud Blog platform vulnerability</a>
									</li>
											<li>
					<a href="../youtube-hacking/index.html">Hacking YouTube Studio</a>
									</li>
											<li>
					<a href="../linkedin-hackers-experience/index.html">LinkedIn Hacker’s Experience</a>
									</li>
					</ul>
		</div> <!-- end .et_pb_widget --><div id="recent-comments-2" class="et_pb_widget widget_recent_comments"><h4 class="widgettitle">Recent Comments</h4><ul id="recentcomments"></ul></div> <!-- end .et_pb_widget --><div id="archives-2" class="et_pb_widget widget_archive"><h4 class="widgettitle">Archives</h4>		<ul>
				<li><a href='../2019/10/index.html'>October 2019</a></li>
	<li><a href='../2019/09/index.html'>September 2019</a></li>
		</ul>
			</div> <!-- end .et_pb_widget --><div id="categories-2" class="et_pb_widget widget_categories"><h4 class="widgettitle">Categories</h4>		<ul>
				<li class="cat-item cat-item-7"><a href="../category/bugbounty/index.html" title="Vulnerabilities found while participating in bug-bounty programs">BugBounty</a>
</li>
	<li class="cat-item cat-item-14"><a href="../category/loosebyte/index.html">LooseByte</a>
</li>
		</ul>
			</div> <!-- end .et_pb_widget --><div id="meta-2" class="et_pb_widget widget_meta"><h4 class="widgettitle">Meta</h4>			<ul>
						<li><a rel="nofollow" href="../wp-login.html">Log in</a></li>
			<li><a href="../feed/index.html">Entries feed</a></li>
			<li><a href="../comments/feed/index.html">Comments feed</a></li>
			<li><a href="https://wordpress.org/">WordPress.org</a></li>			</ul>
			</div> <!-- end .et_pb_widget -->	</div> <!-- end #sidebar -->
		</div> <!-- #content-area -->
	</div> <!-- .container -->
	</div> <!-- #main-content -->


			<footer id="main-footer">
				

		
				<div id="footer-bottom">
					<div class="container clearfix">
				<ul class="et-social-icons">

	<li class="et-social-icon et-social-facebook">
		<a href="https://www.facebook.com/loosebyte" class="icon">
			<span>Facebook</span>
		</a>
	</li>
	<li class="et-social-icon et-social-twitter">
		<a href="https://twitter.com/loose_byte" class="icon">
			<span>Twitter</span>
		</a>
	</li>
	<li class="et-social-icon et-social-rss">
		<a href="../feed/index.html" class="icon">
			<span>RSS</span>
		</a>
	</li>

</ul><div id="footer-info">LooseByte ® All rights reserved 
<br><a href="../cookies-policy/index.html" id="cookies-policy">Cookies Policy</a>
<br><a href="../terms-and-conditions/index.html" id="terms-and-conditions">Terms and Conditions</a></div>					</div>	<!-- .container -->
				</div>
			</footer> <!-- #main-footer -->
		</div> <!-- #et-main-area -->


	</div> <!-- #page-container -->

			<script>
		if(jQuery("form.et_pb_contact_form").length > 0 || (jQuery(".et_pb_newsletter_form").length > 0 && 'yes' == 'yes')) {
			var recaptchascript = document.createElement("script");
			recaptchascript.src = '../../www.google.com/recaptcha/api34b5.js?render=6Lc9WbgUAAAAANyPvtxbwyhY_p8hPhO1pKxcjkL1&amp;onload=onloadCallbackv3';
		    document.head.appendChild(recaptchascript);
			var onloadCallbackv3 = function() {
				grecaptcha.ready(function() {
					grecaptcha.execute('6Lc9WbgUAAAAANyPvtxbwyhY_p8hPhO1pKxcjkL1', {action: 'homepage'}).then(function(token) {
							jQuery('.g-recaptcha-response').val(token)
					});
				});
			};
		}
		</script>
		<!-- 	<script type="text/javascript">
jQuery(document).ready(function(){
	jQuery("form.et_pb_contact_form").each(function(index){
		if(jQuery(this).find(".et_contact_bottom_container .et_pb_contact_right").length > 0){
			var mathcaptchastr = jQuery(this).find('.et_contact_bottom_container .et_pb_contact_captcha_question').html();
			var mathcaptchaarr = mathcaptchastr.split(" ");
			var mathcaptchans = parseInt(mathcaptchaarr[0]) + parseInt(mathcaptchaarr[2]);
			jQuery(this).find('.et_contact_bottom_container .et_pb_contact_captcha').val(parseInt(mathcaptchans));
			jQuery(this).find(".et_contact_bottom_container .et_pb_contact_right").hide();
		}
	});
});
</script> -->
<script>
	jQuery(document).on( "click", ".et_pb_contact_submit", function(e) {
			e.preventDefault();
			var that = jQuery(this);
			var datas = {
			  'action': 'google_recaptcha_validation_v3',
			  'g-recaptcha-response' : that.parents('form').find('.g-recaptcha-response').val(),
			};
			jQuery.ajax({
				url: "https://www.loosebyte.com/wp-admin/admin-ajax.php",
				data: datas,
				type: 'post',
				success: function(data) {
					if(data.success === "false") {
						e.preventDefault();
						alert("Please refresh your page and try again!");
					}
					else {
						jQuery("form.et_pb_contact_form").each(function(index){
							if(jQuery(this).find(".et_contact_bottom_container .et_pb_contact_right").length > 0){
								var mathcaptchastr = jQuery(this).find('.et_contact_bottom_container .et_pb_contact_captcha_question').html();
								var mathcaptchaarr = mathcaptchastr.split(" ");
								var mathcaptchans = parseInt(mathcaptchaarr[0]) + parseInt(mathcaptchaarr[2]);
								jQuery(this).find('.et_contact_bottom_container .et_pb_contact_captcha').val(parseInt(mathcaptchans));
								jQuery(this).find(".et_contact_bottom_container .et_pb_contact_right").hide();
							}
						});
						that.parents('form').submit();
					}
				}
			});
	});
	</script>
<script>
	jQuery(document).on( "click", ".et_pb_newsletter_button", function(e) {
		if(tcap_invisible == 'no' && tcap_optin == 'yes') {
			e.preventDefault();
			var that = jQuery(this);
			var datas = {
			  'action': 'google_recaptcha_validation',
			  'g-recaptcha-response' : that.parents('form').find('.g-recaptcha-response').val(),
			};
			jQuery.ajax({
				url: "https://www.loosebyte.com/wp-admin/admin-ajax.php",
				data: datas,
				type: 'post',
				success: function(data) {
					if(data.nocaptcha === "true" || data.spam === "true") {
						e.preventDefault();
						alert("Please check reCAPTCHA");
					}
					else {
						
						jQuery("form.et_pb_contact_form").each(function(index){
							if(jQuery(this).find(".et_contact_bottom_container .et_pb_contact_right").length > 0){
								var mathcaptchastr = jQuery(this).find('.et_contact_bottom_container .et_pb_contact_captcha_question').html();
								var mathcaptchaarr = mathcaptchastr.split(" ");
								var mathcaptchans = parseInt(mathcaptchaarr[0]) + parseInt(mathcaptchaarr[2]);
								jQuery(this).find('.et_contact_bottom_container .et_pb_contact_captcha').val(parseInt(mathcaptchans));
								jQuery(this).find(".et_contact_bottom_container .et_pb_contact_right").hide();
							}
						});
						that.parents('form').submit();
					}
				}
			});
		}
	});
	</script>
	        <div id="trp-floater-ls" onclick="" data-no-translation class="trp-language-switcher-container trp-floater-ls-names trp-bottom-right" >
            <div id="trp-floater-ls-current-language" class="trp-with-flags">
                <a href="javascript:void(0)" class="trp-floater-ls-disabled-language trp-ls-disabled-language" onclick="void(0)">
					<img class="trp-flag-image" src="../wp-content/plugins/translatepress-multilingual/assets/images/flags/en_US.png" width="18" height="12" alt="en_US" title="English">English				</a>
            </div>
            <div id="trp-floater-ls-language-list" class="trp-with-flags" >
                                    <a href="../ro/google-cloud-vulnerability/index.html"  title="Română">
						<img class="trp-flag-image" src="../wp-content/plugins/translatepress-multilingual/assets/images/flags/ro_RO.png" width="18" height="12" alt="ro_RO" title="Română">Română					</a>
                				<a href="javascript:void(0)"
				   class="trp-floater-ls-disabled-language trp-ls-disabled-language">
					<img class="trp-flag-image" src="../wp-content/plugins/translatepress-multilingual/assets/images/flags/en_US.png" width="18" height="12" alt="en_US" title="English">English				</a>
            </div>
        </div>

    <script type="text/javascript">

jQuery(document).ready(function() {
	/*
    var maincontent_height = jQuery("#main-content").height();
    var window_height = jQuery(window).height();
    if (maincontent_height < window_height) {
        jQuery('#main-footer').css({
            "position": "fixed",
            "bottom": "0px",
            "width": "100%"
        });
        jQuery('body').css({
            "overflow": "hidden"
        });
    }
	*/
	
	jQuery('.reveal').hide();
    jQuery('.rv_button').click(function(e) {
        e.preventDefault();
        
		jQuery(".reveal").show();
		//jQuery(".reveal").slideToggle();
        //jQuery('.rv_button').toggleClass('opened closed');
		//jQuery("html, body").animate({ scrollTop: jQuery(document).height() }, "slow");
    });
});

</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-148129337-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-148129337-1');
</script>	<script type="text/javascript">
	var tcap_sitekey = "6LdeWbgUAAAAAAl9ikDzn8NRj-WlFldTr6LE4pCX";
	var tcap_sitekey_v3 = "6Lc9WbgUAAAAANyPvtxbwyhY_p8hPhO1pKxcjkL1";
	var tcap_theme = "light";
	var tcap_score = "0.5";
	var tcap_invisible = "v3";
	var tcap_optin = "yes";
	
	var onloadCallback = function() {
		grecaptcha.execute();
	};
	if(tcap_invisible == 'yes'){
		var etContactSubmit = function(response) {
			jQuery('.g-recaptcha-response').val(response);
		};
		jQuery("form.et_pb_contact_form").each(function(index){
			jQuery(this).find('.et_contact_bottom_container').prepend('<div class="col-md-12 trumani_con"><div class="g-recaptcha" data-sitekey="'+tcap_sitekey+'" data-size="invisible" data-callback="etContactSubmit"></div></div>');
		});
		if(tcap_optin == 'yes'){
			var etEmailOptinSubmit = function(response) {
				jQuery('.g-recaptcha-response').val(response);
			};
			jQuery('.et_pb_newsletter_form .et_pb_newsletter_button').parent().prepend('<div class="col-md-12 trumani_con"><div class="g-recaptcha" data-sitekey="'+tcap_sitekey+'" data-size="invisible" data-callback="etEmailOptinSubmit"></div></div>');
		}
	}
	else if(tcap_invisible == 'no')
	{
		jQuery("form.et_pb_contact_form").each(function(index){
			jQuery(this).find('.et_contact_bottom_container').prepend('<div class="col-md-12 trumani_con"><div class="g-recaptcha trumani" data-theme="'+tcap_theme+'" data-sitekey="'+tcap_sitekey+'"></div></div>');
		});
		if(tcap_optin == 'yes'){
			jQuery('.et_pb_newsletter_form .et_pb_newsletter_button').parent().prepend('<div class="col-md-12 trumani_con"><div class="g-recaptcha trumani" data-theme="'+tcap_theme+'" data-sitekey="'+tcap_sitekey+'"></div></div>');
		}
	}
	</script>
	<style>.et_contact_bottom_container .et_pb_contact_right{display:none}.et_pb_contact_form .trumani_con{margin-bottom:10px}.et_pb_newsletter_form .trumani_con{margin-bottom:10px}</style>
	

<script defer='defer' id='wpacu-combined-js-body-group-1' type='text/javascript' src='../wp-content/cache/asset-cleanup/js/body-99f096532c70f77e5f038f34304717cfe21bae87-1.js'></script>
<noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic|Raleway:100,100italic,200,200italic,300,300italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic,italic,regular|Titillium+Web:200,200italic,300,300italic,600,600italic,700,700italic,900,italic,regular&amp;subset=latin,latin-ext&amp;display=swap" media="all" /></noscript>
</body>

<!-- Mirrored from www.loosebyte.com/google-cloud-vulnerability/ by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 25 Feb 2020 07:23:31 GMT -->
</html>
